<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phoenix Base Arsenal - Inventory Builder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(to bottom right, #111827, #1e3a8a, #581c87);
            min-height: 100vh;
            color: #e5e7eb;
            padding: 16px;
        }

        .container {
            max-width: 1792px;
            margin: 0 auto;
        }

        .main-card {
            background: rgba(31, 41, 55, 0.9);
            backdrop-filter: blur(4px);
            border-radius: 8px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .header {
            background: linear-gradient(to right, #2563eb, #7c3aed);
            padding: 24px;
            border-radius: 8px 8px 0 0;
        }

        .header h1 {
            font-size: 1.875rem;
            font-weight: bold;
            color: white;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-icon {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .header-icon svg {
            width: 24px;
            height: 24px;
            stroke: white;
        }

        .icon {
            display: inline-block;
            width: 1em;
            height: 1em;
            vertical-align: middle;
            fill: currentColor;
        }

        .header p {
            color: #bfdbfe;
            margin-top: 8px;
        }

        .content {
            padding: 24px;
        }

        .section {
            background: rgba(55, 65, 81, 0.5);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 1rem;
            font-weight: 600;
            color: #d1d5db;
            margin-bottom: 12px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #d1d5db;
            margin-bottom: 8px;
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 8px 16px;
            background: #1f2937;
            border: 1px solid #4b5563;
            border-radius: 8px;
            color: white;
            font-size: 14px;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .armor-selection {
            margin-bottom: 24px;
        }

        .armor-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
        }

        .armor-tab {
            padding: 10px 20px;
            background: #1f2937;
            border: 2px solid #4b5563;
            border-radius: 8px 8px 0 0;
            color: #9ca3af;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .armor-tab:hover {
            background: #374151;
            border-color: #6b7280;
        }

        .armor-tab.active {
            background: rgba(59, 130, 246, 0.2);
            border-color: #3b82f6;
            border-bottom: 2px solid transparent;
            color: #93c5fd;
        }

        .armor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 10px;
            padding: 12px;
            background: rgba(31, 41, 55, 0.5);
            border-radius: 0 8px 8px 8px;
            min-height: 120px;
        }

        .armor-card {
            background: #1f2937;
            border: 2px solid #4b5563;
            border-radius: 8px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .armor-card:hover {
            border-color: #6b7280;
            transform: translateY(-2px);
        }

        .armor-card.selected {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }

        .armor-card.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .armor-name {
            font-weight: 600;
            font-size: 0.875rem;
            color: white;
            margin-bottom: 4px;
        }

        .armor-stats {
            display: flex;
            flex-direction: column;
            gap: 2px;
            font-size: 0.75rem;
            color: #9ca3af;
            margin-top: 4px;
        }

        .armor-stat {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .armor-stat-label {
            color: #6b7280;
            font-weight: 400;
        }

        .armor-stat-value {
            color: #d1d5db;
            font-weight: 500;
        }

        .base-kit-info {
            margin-top: 8px;
            padding: 8px;
            background: rgba(34, 197, 94, 0.1);
            border-radius: 4px;
            border: 1px solid #22c55e;
            font-size: 0.75rem;
            color: #86efac;
        }

        .bulk-display {
            padding: 16px;
            background: rgba(55, 65, 81, 0.5);
            border-radius: 8px;
            margin-bottom: 24px;
        }

        .bulk-display h3 {
            font-size: 1.125rem;
            font-weight: 600;
            color: #d1d5db;
            margin-bottom: 16px;
        }

        .bulk-calculation {
            background: #1f2937;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 12px;
            font-size: 0.875rem;
        }

        .bulk-calc-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
            color: #9ca3af;
        }

        .bulk-calc-row.shield-reduction {
            color: #fbbf24;
        }

        .bulk-calc-total {
            border-top: 1px solid #4b5563;
            padding-top: 8px;
            margin-top: 8px;
            font-weight: 600;
            color: white;
        }

        .bulk-bar {
            width: 100%;
            height: 30px;
            background: #1f2937;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .bulk-fill {
            height: 100%;
            background: linear-gradient(to right, #10b981, #3b82f6);
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .bulk-fill.warning {
            background: linear-gradient(to right, #f59e0b, #dc2626);
        }

        .bulk-fill.danger {
            background: linear-gradient(to right, #dc2626, #991b1b);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .shields-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            cursor: pointer;
            user-select: none;
        }

        .shields-toggle input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .shields-toggle label {
            cursor: pointer;
            color: #93c5fd;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .shields-section {
            display: none;
        }

        .shields-section.active {
            display: block;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 24px;
        }

        .categories-panel {
            background: rgba(55, 65, 81, 0.5);
            border-radius: 8px;
            padding: 16px;
        }

        .category-btn {
            width: 100%;
            padding: 12px;
            margin-bottom: 8px;
            background: #1f2937;
            border: 2px solid #4b5563;
            border-radius: 8px;
            color: #d1d5db;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            font-size: 0.875rem;
        }

        .category-btn:hover {
            border-color: #6b7280;
            background: #374151;
        }

        .category-btn.active {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.2);
            color: white;
        }

        .items-section {
            background: rgba(55, 65, 81, 0.5);
            border-radius: 8px;
            padding: 16px;
        }

        .search-bar {
            width: 100%;
            padding: 8px 16px;
            margin-bottom: 16px;
            background: #1f2937;
            border: 1px solid #4b5563;
            border-radius: 8px;
            color: white;
        }

        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 12px;
            max-height: 500px;
            overflow-y: auto;
            padding-right: 8px;
        }

        .item-card {
            background: #1f2937;
            border: 2px solid #4b5563;
            border-radius: 8px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .item-card:hover {
            border-color: #6b7280;
            transform: translateY(-2px);
        }

        .item-card.has-items {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 8px;
        }

        .item-name {
            font-weight: 600;
            font-size: 0.875rem;
            color: white;
        }

        .item-bulk {
            background: rgba(59, 130, 246, 0.2);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.75rem;
            color: #93c5fd;
        }

        .item-description {
            font-size: 0.75rem;
            color: #9ca3af;
            margin-bottom: 8px;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
        }

        .quantity-btn {
            width: 24px;
            height: 24px;
            background: #374151;
            border: 1px solid #4b5563;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .quantity-btn:hover:not(:disabled) {
            background: #4b5563;
        }

        .quantity-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .quantity-display {
            min-width: 40px;
            text-align: center;
            font-size: 0.875rem;
            color: white;
        }

        .inventory-section {
            margin-top: 24px;
            background: rgba(55, 65, 81, 0.5);
            border-radius: 8px;
            padding: 16px;
        }

        .inventory-list {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 8px;
        }

        .inventory-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            background: #1f2937;
            border-radius: 8px;
            border: 1px solid #4b5563;
        }

        .inventory-item.base-kit {
            background: rgba(59, 130, 246, 0.1);
            border-color: #3b82f6;
        }

        .base-kit-contents {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #4b5563;
        }

        .base-kit-item {
            font-size: 0.75rem;
            color: #9ca3af;
            margin-left: 16px;
            margin-bottom: 2px;
        }

        .remove-btn {
            background: #dc2626;
            color: white;
            border: none;
            padding: 4px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: background 0.3s ease;
        }

        .remove-btn:hover {
            background: #991b1b;
        }

        .export-section {
            margin-top: 24px;
            text-align: center;
        }

        .export-btn {
            padding: 12px 32px;
            background: linear-gradient(to right, #2563eb, #7c3aed);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .export-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .export-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .warning-text {
            color: #fbbf24;
            margin-top: 8px;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .requirement-warning {
            color: #ef4444;
            font-size: 0.75rem;
            margin-top: 4px;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1f2937;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: #4b5563;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .armor-grid {
                grid-template-columns: 1fr;
            }
            
            .items-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-card">
            <div class="header">
                <h1>
                    <div class="header-icon">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <circle cx="12" cy="12" r="6"/>
                            <circle cx="12" cy="12" r="2"/>
                        </svg>
                    </div>
                    Phoenix Base Arsenal
                </h1>
                <p>Equipment Requisition & Inventory Management System</p>
            </div>

            <div class="content">
                <!-- Character Configuration Section -->
                <div class="section">
                    <h3 class="section-title">Character Configuration</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                        <div class="form-group">
                            <label for="strScore">Strength Score:</label>
                            <input type="number" id="strScore" min="3" max="20" value="10" />
                            <small style="color: #93c5fd; font-size: 0.75rem;">Modifier: <span id="strModDisplay">+0</span> | Affects bulk capacity</small>
                        </div>
                        <div class="form-group">
                            <label for="baseKit">Base Kit Configuration:</label>
                            <select id="baseKit">
                                <option value="1-prep">1-Prep (Standard Base Kit)</option>
                                <option value="2-prep">2-Prep (Gate Camp Kit)</option>
                                <option value="3-prep">3-Prep (Extended Camp Kit)</option>
                                <option value="4-prep">4-Prep (Frontline Kit)</option>
                            </select>
                            <div class="base-kit-info">
                                ‚ÑπÔ∏è Base Kit equipment does NOT count towards your bulk limit
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Armor Selection Section -->
                <div class="section armor-selection">
                    <h3 class="section-title">Armor Selection</h3>
                    
                    <div class="armor-tabs">
                        <button class="armor-tab active" onclick="switchArmorTab(event, 'common')">Common Armor</button>
                        <button class="armor-tab" onclick="switchArmorTab(event, 'tauri')">Tau'ri Armor</button>
                    </div>
                    
                    <div class="armor-grid" id="armorGrid">
                        <!-- Armor cards will be displayed here -->
                    </div>

                    <div class="shields-toggle" style="margin-top: 16px;">
                        <input type="checkbox" id="showShields" onchange="toggleShieldsSection()">
                        <label for="showShields">Include Shield Equipment</label>
                    </div>

                    <div class="shields-section" id="shieldsSection">
                        <h4 style="margin-bottom: 12px; color: #93c5fd; font-size: 0.875rem;">Shields (Reduces Bulk Capacity)</h4>
                        <div class="armor-grid" id="shieldGrid">
                            <!-- Shield cards will be displayed here -->
                        </div>
                    </div>
                </div>

                <div class="bulk-display">
                    <h3>Bulk Capacity</h3>
                    <div class="bulk-calculation">
                        <div class="bulk-calc-row">
                            <span>Base from Armor:</span>
                            <span id="armorBulkBase">6</span>
                        </div>
                        <div class="bulk-calc-row">
                            <span>Strength Modifier:</span>
                            <span id="strBulkMod">+0</span>
                        </div>
                        <div class="bulk-calc-row shield-reduction" id="shieldReductionRow" style="display: none;">
                            <span>Shield Reduction:</span>
                            <span id="shieldBulkReduction">-0</span>
                        </div>
                        <div class="bulk-calc-row bulk-calc-total">
                            <span>Total Capacity:</span>
                            <span id="totalBulkCapacity">6</span>
                        </div>
                    </div>
                    <div class="bulk-bar">
                        <div class="bulk-fill" id="bulkFill">0 / 6</div>
                    </div>
                    <div id="bulkWarning" class="warning-text" style="display: none;">
                        ‚ö†Ô∏è Warning: Inventory exceeds bulk capacity!
                    </div>
                </div>

                <div class="main-grid">
                    <div class="categories-panel">
                        <h3 style="font-size: 0.875rem; font-weight: 600; color: #d1d5db; margin-bottom: 12px;">Equipment Categories</h3>
                        <button class="category-btn active" data-category="all">All Equipment</button>
                        <button class="category-btn" data-category="common-weapons">Common Weapons</button>
                        <button class="category-btn" data-category="tauri-weapons">Tau'ri Weapons</button>
                        <button class="category-btn" data-category="explosives">Explosives</button>
                        <button class="category-btn" data-category="medical">Medical</button>
                        <button class="category-btn" data-category="tools">Tools & Kits</button>
                        <button class="category-btn" data-category="communications">Communications</button>
                        <button class="category-btn" data-category="survival">Survival Gear</button>
                        <button class="category-btn" data-category="alien">Alien Tech</button>
                    </div>

                    <div class="items-section">
                        <input type="text" class="search-bar" id="searchBar" placeholder="Search equipment...">
                        <div class="items-grid" id="itemsGrid">
                            <!-- Items will be populated here -->
                        </div>
                    </div>
                </div>

                <div class="inventory-section">
                    <h3 style="font-size: 1.125rem; font-weight: 600; color: #d1d5db; margin-bottom: 12px;">Current Inventory</h3>
                    <div class="inventory-list" id="inventoryList">
                        <!-- Inventory will be displayed here -->
                    </div>
                </div>

                <div class="export-section">
                    <button class="export-btn" id="exportBtn">
                        <span>üì•</span>
                        Export Inventory Loadout
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Armor database
        const armors = {
            common: [
                { name: "No Armor", type: "None", ac: "10+Dex", bulkBase: 6, strReq: null },
                { name: "Furs", type: "Light", ac: "11+Dex", bulkBase: 6, strReq: null },
                { name: "Leather", type: "Light", ac: "13+Dex", bulkBase: 6, strReq: null },
                { name: "Chainmail", type: "Heavy", ac: "16", bulkBase: 4, strReq: 13 },
                { name: "Platemail", type: "Heavy", ac: "18", bulkBase: 3, strReq: 15 }
            ],
            tauri: [
                { name: "Bullet Resistant Vest", type: "Light", ac: "14+Dex", bulkBase: 6, strReq: null },
                { name: "Tactical Vest", type: "Light", ac: "16+Dex", bulkBase: 8, strReq: null },
                { name: "Tactical Armor", type: "Heavy", ac: "20", bulkBase: 6, strReq: 13 }
            ],
            shields: [
                { name: "Shield", type: "Heavy", ac: "+2", bulkReduction: 1, strReq: null },
                { name: "Blast Shield", type: "Heavy", ac: "+2", bulkReduction: 2, strReq: null }
            ]
        };

        // Equipment database 
        const equipment = [
            // Common Weapons
            { name: "Greatblade", bulk: 2, category: "common-weapons", description: "Weapon that deals 1d8 slashing damage" },            
            { name: "Shortblade", bulk: 1, category: "common-weapons", description: "Finesse weapon that deals 1d6 piercing damage" },
            { name: "Blade", bulk: 1, category: "common-weapons", description: "Finesse weapon that deals 1d8 piercing and slashing damage" },
            { name: "Bow", bulk: 2, category: "common-weapons", description: "Range weapon(50m) that deals 1d6 piercing damage" },
            { name: "Crossbow", bulk: 1, category: "common-weapons", description: "Range weapon(40m) that deals 1d8 piercing damage" },
            { name: "Polearm", bulk: 2, category: "common-weapons", description: "Long range melee weapon(2m) that deals 1d8 piercing damage" },
            { name: "Sling", bulk: 1, category: "common-weapons", description: "Range finesse weapon(30m) that deals 1d4 bludgeoning damage" },
            { name: "Spear", bulk: 1, category: "common-weapons", description: "Melee weapon that deals 1d6 piercing damage(Can be thrown)" },
            { name: "Thrown Blade(x5)", bulk: 1, category: "common-weapons", description: "Thrown weapon(5m) that deals 1d6 piercing damage" },
            { name: "Axe", bulk: 1, category: "common-weapons", description: "Weapon that deals 1d8 slashing damage" },
            { name: "Club", bulk: 1, category: "common-weapons", description: "Weapon that deals 1d4 bludgeoning damage" },
            { name: "Whip", bulk: 1, category: "common-weapons", description: "Finesse weapon that deals 1d4 slashing damage(Can trip or disarm target)" },
            { name: "Greathammer", bulk: 2, category: "common-weapons", description: "Weapon and deals 1d6 bludgeoning damage(Target might be prone)" },

            // Tau'ri Weapons
            { name: "FN P90", bulk: 2, category: "tauri-weapons", description: "Standard issue longarm, 30 round capacity" },
            { name: "Beretta M9", bulk: 1, category: "tauri-weapons", description: "Standard sidearm, 15 round capacity" },
            { name: "Mossberg 500", bulk: 2, category: "tauri-weapons", description: "Pump-action shotgun, scatter weapon" },
            { name: "Grenade Launcher", bulk: 2, category: "tauri-weapons", description: "Launches grenades at extended range. Ask your GM first" },
            { name: "Chain Gun", bulk: 4, category: "tauri-weapons", description: "Heavy automatic weapon, 100 rounds of capacity. Ask your GM first" },
            { name: "RPG", bulk: 3, category: "tauri-weapons", description: "Rocket-propelled grenade. Ask your GM first" },
            { name: "Tranquilizer Rifle", bulk: 2, category: "tauri-weapons", description: "Non-lethal sedative weapon" },
            { name: "Spare Magazines", bulk: 1, category: "tauri-weapons", description: "2 magazines for any weapon" },
            
            // Explosives
            { name: "C4 Explosive Clay(3x)", bulk: 1, category: "explosives", description: "Explosive clay that deals 1d10 damage(1m). Max 20 stacks" },
            { name: "C4 Detonator", bulk: 0, category: "explosives", description: "Radio receiver for C4" },
            { name: "Claymore Mine", bulk: 1, category: "explosives", description: "Directional antipersonnel mine that deals 8d6 damage" },
            { name: "Fragmentation Grenade(3x)", bulk: 1, category: "explosives", description: "Standard grenade 3mx3m that deals 6d6 force damage" },
            { name: "Smoke Grenade(3x)", bulk: 1, category: "explosives", description: "Fills 5m x 5m area with smoke" },
            { name: "Flash-Bang Grenade(3x)", bulk: 1, category: "explosives", description: "3 grenades, blinds and deafens" },
            
            // Medical
            { name: "Med Kit", bulk: 2, category: "medical", description: "Full medical supplies for field treatment" },
            { name: "Emergency Viral Response", bulk: 0, category: "medical", description: "Auto-injector for toxins" },
            { name: "Outbreak Kit", bulk: 1, category: "medical", description: "Disease containment supplies" },
            
            // Tools & Kits
            { name: "Engineering Kit", bulk: 1, category: "tools", description: "Tools for repairs and modifications" },
            { name: "Research Kit", bulk: 1, category: "tools", description: "Scientific analysis equipment" },
            { name: "Climbing Kit", bulk: 1, category: "tools", description: "Ropes, hooks, and carabiners" },
            { name: "Camo Kit", bulk: 1, category: "tools", description: "Camouflage for stealth operations" },
            { name: "Duct Tape", bulk: 1, category: "tools", description: "100m roll" },
            { name: "Utility Ties", bulk: 1, category: "tools", description: "100 zip ties" },
            { name: "Rope", bulk: 1, category: "tools", description: "100m nylon rope" },
            { name: "Binoculars", bulk: 1, category: "tools", description: "Magnified vision device" },
            { name: "Grapple Gun", bulk: 1, category: "tools", description: "Launches grappling hook" },
            { name: "Fabrication Kit", bulk: 10, category: "tools", description: "Heavy equipment craftman tools" },
            { name: "Thieves' Tools", bulk: 1, category: "tools", description: "Lockpicking and bypass equipment" },
            
            // Communications
            { name: "Radio Relay", bulk: 2, category: "communications", description: "Extends radio range up to 20km radius" },
            { name: "Communications Balloon", bulk: 2, category: "communications", description: "Launchable baloon that extends radio range to 500km" },
            { name: "G.D.O.", bulk: 1, category: "communications", description: "Garage Door Opener, send your ID for verification at the SGC" },
            { name: "Translator", bulk: 1, category: "communications", description: "Universal language database" },
            { name: "Personal Computer", bulk: 1, category: "communications", description: "Laptop or tablet device" },
            { name: "Signal Beacon", bulk: 1, category: "communications", description: "Emergency locator beacon" },
            { name: "Radio Station", bulk: 40, category: "communications", description: "Long-range communications setup(100km)" },
            
            // Survival Gear
            { name: "MRE Pack(5x)", bulk: 1, category: "survival", description: "Food - 1 day of rations" },
            { name: "SCUBA Gear", bulk: 2, category: "survival", description: "Underwater breathing apparatus" },
            { name: "Parachute", bulk: 3, category: "survival", description: "Backpack with canopy" },
            { name: "Space Suit", bulk: 5, category: "survival", description: "Suit for space travel" },
            { name: "Inflatable Boat", bulk: 2, category: "survival", description: "Portable water transport" },
            { name: "Solar Recharging Station", bulk: 2, category: "survival", description: "Renewable power source" },
            { name: "Generator", bulk: 3, category: "survival", description: "Portable power generator" },
            { name: "Water Purifier", bulk: 1, category: "survival", description: "Water filter container" },
            { name: "Sleeping Bag", bulk: 2, category: "survival", description: "Insulated bedroll" },
            
            // Alien Tech
            { name: "Ma'tok Staff", bulk: 2, category: "alien", description: "Jaffa energy weapon" },
            { name: "Zat'nik'tel", bulk: 1, category: "alien", description: "Goa'uld stun weapon" },
            { name: "Clak Blade (Unas)", bulk: 1, category: "alien", description: "Shortblade worn on wrist bracer that will can grapple the target and deal 1d8 damage(Unas deal extra claw damage)" },
            { name: "Unas Necklace", bulk: 0, category: "alien", description: "Bone chocker that blocks the area a Goa'uld would enter the host" },
            { name: "Elio'so Paste(10x)", bulk: 1, category: "alien", description: "Emergency food, 10 uses can heal HP and attribute damage" },
            { name: "Ud'Wat Incense(10x)", bulk: 1, category: "alien", description: "Setate and enter the dreamscape" },
            { name: "Monitoring Implant", bulk: 0, category: "alien", description: "Tollan medical monitoring implant" },
            { name: "Naquadah Generator", bulk: 3, category: "alien", description: "Advanced power source" },
            { name: "Phase Device", bulk: 1, category: "alien", description: "Tollan wrist-worn device to phase out of sync" },
            { name: "Tok'ra Tunneling Crystals", bulk: 1, category: "alien", description: "Creates underground passages" },
            { name: "Healing Device", bulk: 1, category: "alien", description: "Goa'uld healing technology" }
        ];

        // Base kit contents
        const baseKitContents = {
            '1-prep': [
                'Tactical Vest & 3 Uniforms',
                'MREs (Food)',
                'Combat Knife (Shortblade, Tech Level 2)',
                'Personal Tactical Radio',
                'Flashlight',
                'Water Purifier',
                'Filtration/Radiation Mask',
                'Multi-tool',
                'Personal Medical Kit',
                'Extended Climate Protection Clothing',
                'Combat Tent',
                'Sidearm (Beretta M9) w/2 magazines',
                'Longarm (FN P90 or Mossberg 500) w/2 magazines'
            ],
            '2-prep': [
                'All 1-Prep items',
                'Phoenix Gate Camp Kit (team shared)',
                '3 spare FN P90s',
                '6 spare Beretta M9s',
                '3 additional combat tents',
                '3 additional multi-tools',
                'Inflatable Boat',
                '3 months MREs per team member',
                '3 Medical Kits',
                '5km nylon rope',
                'Service & repair tools',
                '5 bags Concrete',
                'Solar Recharging Station',
                '3 Generators w/3 months fuel',
                '10,000 rounds ammunition'
            ],
            '3-prep': [
                'All 2-Prep items',
                '6 additional combat tents',
                'Medical Tent (fully stocked)',
                '5km additional rope',
                '10 bags Concrete',
                'Tactical radio relay',
                '50,000 rounds ammunition',
                '1 ATV per team member + 2 spare'
            ],
            '4-prep': [
                'All 3-Prep items',
                'Frontline base facilities',
                'Fabrication and repair facilities',
                'Prefab perimeter wall',
                'Guard towers and buildings',
                '3 Extended Camp kits worth of supplies'
            ]
        };

        // State management
        let selectedArmor = null;
        let selectedShield = null;
        let currentArmorCategory = 'common';
        let inventory = {};
        let currentCategory = 'all';
        let searchTerm = '';
        let strScore = 10;
        let strModifier = 0;
        let bulkCapacity = 6;
        let effectiveBulkCapacity = 6;
        let currentBaseKit = '1-prep';

        // Calculate modifier from strength score
        function calculateStrModifier(strength) {
            return Math.floor((strength - 10) / 2);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            renderArmorOptions('common');
            renderShields();
            renderItems();
            setupEventListeners();
            updateInventoryDisplay();
            updateBulkCalculation();
        });

        function toggleShieldsSection() {
            const checkbox = document.getElementById('showShields');
            const shieldsSection = document.getElementById('shieldsSection');
            
            if (checkbox.checked) {
                shieldsSection.classList.add('active');
            } else {
                shieldsSection.classList.remove('active');
                // Deselect shield when hiding the section
                if (selectedShield) {
                    selectedShield = null;
                    renderShields();
                    updateBulkCalculation();
                    updateInventoryDisplay();
                }
            }
        }

        function switchArmorTab(event, category) {
            currentArmorCategory = category;
            
            // Update tab styles
            document.querySelectorAll('.armor-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Render armor for selected category
            renderArmorOptions(category);
        }

        function renderArmorOptions(category) {
            const armorGrid = document.getElementById('armorGrid');
            const armorList = armors[category];
            
            armorGrid.innerHTML = armorList.map(armor => {
                const meetsRequirement = !armor.strReq || strScore >= armor.strReq;
                const isDisabled = !meetsRequirement;
                
                return `
                    <div class="armor-card ${selectedArmor && selectedArmor.name === armor.name ? 'selected' : ''} ${isDisabled ? 'disabled' : ''}" 
                         ${!isDisabled ? `onclick="selectArmor('${category}', '${armor.name}')"` : ''} 
                         data-armor="${armor.name}">
                        <div class="armor-name">${armor.name}</div>
                        <div class="armor-stats">
                            <div class="armor-stat">
                                <span class="armor-stat-label">Type:</span>
                                <span class="armor-stat-value">${armor.type}</span>
                            </div>
                            <div class="armor-stat">
                                <span class="armor-stat-label">AC:</span>
                                <span class="armor-stat-value">${armor.ac}</span>
                            </div>
                            <div class="armor-stat">
                                <span class="armor-stat-label">Bulk:</span>
                                <span class="armor-stat-value">${armor.bulkBase}+Str</span>
                            </div>
                        </div>
                        ${armor.strReq && !meetsRequirement ? '<div class="requirement-warning">‚ö†Ô∏è Requires STR ' + armor.strReq + '+</div>' : ''}
                    </div>
                `;
            }).join('');
            
            // If no armor is selected, select the first one
            if (!selectedArmor && category === 'common') {
                selectArmor('common', 'No Armor');
            }
        }

        function renderShields() {
            const shieldGrid = document.getElementById('shieldGrid');
            const allShields = armors.shields;
            
            shieldGrid.innerHTML = allShields.map(shield => `
                <div class="armor-card ${selectedShield && selectedShield.name === shield.name ? 'selected' : ''}" 
                     onclick="toggleShield('${shield.name}')" 
                     data-shield="${shield.name}">
                    <div class="armor-name">${shield.name}</div>
                    <div class="armor-stats">
                        <div class="armor-stat">
                            <span class="armor-stat-label">Type:</span>
                            <span class="armor-stat-value">${shield.type}</span>
                        </div>
                        <div class="armor-stat">
                            <span class="armor-stat-label">AC:</span>
                            <span class="armor-stat-value">${shield.ac}</span>
                        </div>
                        <div class="armor-stat">
                            <span class="armor-stat-label">Bulk Red.:</span>
                            <span class="armor-stat-value">-${shield.bulkReduction}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function toggleShield(shieldName) {
            const shield = armors.shields.find(s => s.name === shieldName);
            
            if (selectedShield && selectedShield.name === shieldName) {
                // Deselect the shield
                selectedShield = null;
            } else {
                // Select the shield
                selectedShield = shield;
            }
            
            renderShields();
            updateBulkCalculation();
            updateInventoryDisplay();
        }

        function selectArmor(category, armorName) {
            // Find the armor
            const armor = armors[category].find(a => a.name === armorName);
            
            // Check if armor meets strength requirements
            if (armor && armor.strReq && strScore < armor.strReq) {
                return; // Don't allow selection if requirements not met
            }
            
            if (armor) {
                selectedArmor = armor;
                
                // If we're selecting from a different category, switch to that tab
                if (category !== currentArmorCategory) {
                    document.querySelectorAll('.armor-tab').forEach(tab => {
                        tab.classList.remove('active');
                    });
                    const tabButton = category === 'common' 
                        ? document.querySelector('.armor-tab:first-child')
                        : document.querySelector('.armor-tab:nth-child(2)');
                    if (tabButton) {
                        tabButton.classList.add('active');
                    }
                    currentArmorCategory = category;
                    renderArmorOptions(category);
                } else {
                    // Update selection in current view
                    document.querySelectorAll('.armor-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                    const card = document.querySelector(`[data-armor="${armorName}"]`);
                    if (card) {
                        card.classList.add('selected');
                    }
                }
                
                updateBulkCalculation();
                updateInventoryDisplay();
            }
        }

        function updateBulkCalculation() {
            if (!selectedArmor) {
                selectedArmor = armors.common[0]; // Default to "No Armor"
            }

            const baseBulk = selectedArmor.bulkBase;
            const shieldReduction = selectedShield ? selectedShield.bulkReduction : 0;
            
            bulkCapacity = Math.max(1, baseBulk + strModifier);
            effectiveBulkCapacity = Math.max(1, bulkCapacity - shieldReduction);

            // Update display
            document.getElementById('armorBulkBase').textContent = baseBulk;
            document.getElementById('strBulkMod').textContent = strModifier >= 0 ? `+${strModifier}` : strModifier;
            
            // Show/hide shield reduction row
            const shieldRow = document.getElementById('shieldReductionRow');
            if (shieldReduction > 0) {
                shieldRow.style.display = 'flex';
                document.getElementById('shieldBulkReduction').textContent = `-${shieldReduction}`;
            } else {
                shieldRow.style.display = 'none';
            }
            
            document.getElementById('totalBulkCapacity').textContent = effectiveBulkCapacity;

            updateBulkDisplay();
        }

        function setupEventListeners() {
            // Strength score
            document.getElementById('strScore').addEventListener('input', function(e) {
                strScore = parseInt(e.target.value) || 10;
                strModifier = calculateStrModifier(strScore);
                document.getElementById('strModDisplay').textContent = strModifier >= 0 ? `+${strModifier}` : strModifier;
                
                // Check if currently selected armor is still valid
                if (selectedArmor && selectedArmor.strReq && strScore < selectedArmor.strReq) {
                    // Deselect armor if it no longer meets requirements
                    selectedArmor = null;
                }
                
                // Re-render armor options to update disabled states
                renderArmorOptions(currentArmorCategory);
                
                updateBulkCalculation();
                updateInventoryDisplay();
            });

            // Category buttons
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentCategory = this.dataset.category;
                    renderItems();
                });
            });

            // Search bar
            document.getElementById('searchBar').addEventListener('input', function(e) {
                searchTerm = e.target.value.toLowerCase();
                // Automatically switch to "all" category when searching
                if (searchTerm) {
                    currentCategory = 'all';
                    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                    document.querySelector('.category-btn[data-category="all"]').classList.add('active');
                }
                renderItems();
            });

            // Base kit change
            document.getElementById('baseKit').addEventListener('change', function(e) {
                currentBaseKit = e.target.value;
                updateInventoryDisplay();
            });

            // Export button
            document.getElementById('exportBtn').addEventListener('click', exportInventory);
        }

        function renderItems() {
            const itemsGrid = document.getElementById('itemsGrid');
            let filteredItems = equipment;

            // Filter by category
            if (currentCategory !== 'all') {
                filteredItems = filteredItems.filter(item => item.category === currentCategory);
            }

            // Filter by search
            if (searchTerm) {
                filteredItems = filteredItems.filter(item => 
                    item.name.toLowerCase().includes(searchTerm) ||
                    item.description.toLowerCase().includes(searchTerm)
                );
            }

            // Render items with quantity controls
            itemsGrid.innerHTML = filteredItems.map(item => {
                const quantity = inventory[item.name] || 0;
                return `
                    <div class="item-card ${quantity > 0 ? 'has-items' : ''}">
                        <div class="item-header">
                            <div class="item-name">${item.name}</div>
                            <span class="item-bulk">Bulk: ${item.bulk}</span>
                        </div>
                        <div class="item-description">${item.description}</div>
                        <div class="quantity-controls">
                            <button class="quantity-btn" onclick="updateQuantity('${item.name.replace(/'/g, "\\'")}', -1)" ${quantity === 0 ? 'disabled' : ''}>‚àí</button>
                            <div class="quantity-display">${quantity}</div>
                            <button class="quantity-btn" onclick="updateQuantity('${item.name.replace(/'/g, "\\'")}', 1)">+</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateQuantity(itemName, change) {
            const currentQty = inventory[itemName] || 0;
            const newQty = Math.max(0, currentQty + change);
            
            if (newQty === 0) {
                delete inventory[itemName];
            } else {
                inventory[itemName] = newQty;
            }
            
            renderItems();
            updateInventoryDisplay();
            updateBulkDisplay();
        }

        function updateInventoryDisplay() {
            const inventoryList = document.getElementById('inventoryList');
            let html = '';
            
            // Show selected armor first
            if (selectedArmor && selectedArmor.name !== 'No Armor') {
                html += `
                    <div class="inventory-item" style="background: rgba(147, 51, 234, 0.1); border-color: #8b5cf6;">
                        <div style="flex: 1;">
                            <strong style="color: #8b5cf6;">Armor: ${selectedArmor.name}</strong>
                            <div style="font-size: 0.75rem; color: #9ca3af; margin-top: 4px;">
                                Type: ${selectedArmor.type}, AC: ${selectedArmor.ac}, Base Bulk Capacity: ${bulkCapacity}
                            </div>
                        </div>
                    </div>
                `;
            }

            // Show selected shield
            if (selectedShield) {
                html += `
                    <div class="inventory-item" style="background: rgba(251, 191, 36, 0.1); border-color: #fbbf24;">
                        <div style="flex: 1;">
                            <strong style="color: #fbbf24;">Shield: ${selectedShield.name}</strong>
                            <div style="font-size: 0.75rem; color: #9ca3af; margin-top: 4px;">
                                AC: ${selectedShield.ac}, Reduces bulk capacity by ${selectedShield.bulkReduction}
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // Always show base kit
            html += `
                <div class="inventory-item base-kit">
                    <div style="flex: 1;">
                        <strong style="color: #3b82f6;">Base Kit: ${currentBaseKit.toUpperCase()}</strong> (No Bulk Cost)
                        <div class="base-kit-contents">
                            ${baseKitContents[currentBaseKit].map(item => 
                                `<div class="base-kit-item">‚Ä¢ ${item}</div>`
                            ).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            // Show additional requisitioned items
            const hasItems = Object.keys(inventory).length > 0;
            if (hasItems) {
                Object.entries(inventory).forEach(([itemName, quantity]) => {
                    const item = equipment.find(e => e.name === itemName);
                    if (item) {
                        const totalBulk = item.bulk * quantity;
                        html += `
                            <div class="inventory-item">
                                <div style="flex: 1;">
                                    <strong>${itemName}</strong> √ó ${quantity} (Total Bulk: ${totalBulk})
                                    <div style="font-size: 0.75rem; color: #9ca3af; margin-top: 4px;">${item.description}</div>
                                </div>
                                <button class="remove-btn" onclick="removeItem('${itemName.replace(/'/g, "\\'")}')">Remove All</button>
                            </div>
                        `;
                    }
                });
            } else {
                html += '<p style="text-align: center; color: #6b7280; margin-top: 16px;">No additional equipment selected</p>';
            }
            
            inventoryList.innerHTML = html;
        }

        function removeItem(itemName) {
            delete inventory[itemName];
            renderItems();
            updateInventoryDisplay();
            updateBulkDisplay();
        }

        function updateBulkDisplay() {
            let totalBulk = 0;
            
            // Calculate total bulk from inventory
            Object.entries(inventory).forEach(([itemName, quantity]) => {
                const item = equipment.find(e => e.name === itemName);
                if (item) {
                    totalBulk += item.bulk * quantity;
                }
            });
            
            const bulkFill = document.getElementById('bulkFill');
            const bulkWarning = document.getElementById('bulkWarning');
            
            const percentage = Math.min((totalBulk / effectiveBulkCapacity) * 100, 150);
            bulkFill.style.width = Math.max(percentage, 20) + '%';
            bulkFill.textContent = `${totalBulk} / ${effectiveBulkCapacity}`;
            
            // Update color based on capacity
            bulkFill.classList.remove('warning', 'danger');
            if (totalBulk > effectiveBulkCapacity) {
                bulkFill.classList.add('danger');
                bulkWarning.style.display = 'flex';
            } else if (totalBulk === effectiveBulkCapacity) {
                bulkFill.classList.add('warning');
                bulkWarning.style.display = 'none';
            } else {
                bulkWarning.style.display = 'none';
            }
        }

        function exportInventory() {
            let totalBulk = 0;
            Object.entries(inventory).forEach(([itemName, quantity]) => {
                const item = equipment.find(e => e.name === itemName);
                if (item) {
                    totalBulk += item.bulk * quantity;
                }
            });
            
            let output = `PHOENIX BASE EQUIPMENT REQUISITION
========================================
Date: ${new Date().toLocaleDateString()}
Time: ${new Date().toLocaleTimeString()}

## CHARACTER CONFIGURATION

Armor: ${selectedArmor ? selectedArmor.name : 'None'}
Armor Type: ${selectedArmor ? selectedArmor.type : 'N/A'}
Armor AC: ${selectedArmor ? selectedArmor.ac : '10+Dex'}
Shield: ${selectedShield ? selectedShield.name : 'None'}
Shield AC: ${selectedShield ? selectedShield.ac : 'N/A'}
Strength: ${strScore} (${strModifier >= 0 ? '+' : ''}${strModifier} modifier)

## BASE CONFIGURATION

Base Kit: ${currentBaseKit.toUpperCase()}
Base Bulk Capacity: ${bulkCapacity} (${selectedArmor ? selectedArmor.bulkBase : 6} base ${strModifier >= 0 ? '+' : ''}${strModifier} STR)
Shield Reduction: ${selectedShield ? '-' + selectedShield.bulkReduction : '0'}
Effective Capacity: ${effectiveBulkCapacity}
Current Usage: ${totalBulk}/${effectiveBulkCapacity}
Status: ${totalBulk > effectiveBulkCapacity ? '‚ö†Ô∏è OVERLOADED' : '‚úì WITHIN LIMITS'}

## BASE KIT CONTENTS (No Bulk Cost)

${baseKitContents[currentBaseKit].map(item => `‚Ä¢ ${item}`).join('\n')}

## ADDITIONAL REQUISITIONED EQUIPMENT

‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî`;

            if (Object.keys(inventory).length === 0) {
                output += '\nNo additional equipment selected';
            } else {
                // Group by category
                const categories = {};
                Object.entries(inventory).forEach(([itemName, quantity]) => {
                    const item = equipment.find(e => e.name === itemName);
                    if (item) {
                        if (!categories[item.category]) {
                            categories[item.category] = [];
                        }
                        categories[item.category].push({ ...item, quantity });
                    }
                });
                
                for (const [category, items] of Object.entries(categories)) {
                    const categoryName = category.replace('-', ' ').toUpperCase();
                    output += `\n\n${categoryName}:`;
                    items.forEach(item => {
                        const totalBulk = item.bulk * item.quantity;
                        output += `\n‚Ä¢ ${item.name} √ó ${item.quantity} (Total Bulk: ${totalBulk})`;
                        output += `\n  ${item.description}`;
                    });
                }
            }
            
            output += '\n\n========================================\nEND OF REQUISITION FORM\n';
            
            // Download the file
            const blob = new Blob([output], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Phoenix_Inventory_${new Date().toISOString().slice(0,10)}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Make functions globally accessible
        window.switchArmorTab = switchArmorTab;
        window.selectArmor = selectArmor;
        window.toggleShield = toggleShield;
        window.toggleShieldsSection = toggleShieldsSection;
        window.updateQuantity = updateQuantity;
        window.removeItem = removeItem;
        window.exportInventory = exportInventory;
    </script>
</body>
</html>
